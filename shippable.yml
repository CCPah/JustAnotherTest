language: java

jdk:
  - oraclejdk8

env:
  - NIGHTLYBUILD=$BRANCH $JOB_TRIGGERED_BY_NAME
  - NIGHTLYBUILD=testbranch $JOB_TRIGGERED_BY_NAME

matrix:
    allow_failures:
        - env: NIGHTLYBUILD=testbranch

    exclude:
        - env:
            - NIGHTLYBUILD=testbranch $JOB_TRIGGERED_BY_NAME=""
  
build:
  ci:
   - git checkout $NIGHTLYBUILD
   - cd mvn-parent
   - mvn clean verify surefire:test --fail-at-end